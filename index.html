<!DOCTYPE html>
<html lang="en" ng-app="listaTelefonica">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista Telefônica</title>
    <script src="./lib/angular/angular.js"></script>
    <script src="./lib/angular/angular-messages.js"></script>
    <script src="./lib/serialGenerator/serialGenerator.js"></script>
    <script src="./lib/uiAccordion/uiAccordion.js"></script>

    <script src="./js/app.js"></script>
    <script src="./js/controllers/listaTelefonicaCrtl.js"></script>
    <script src="./js/services/contatosService.js"></script>
    <script src="./js/services/operadorasService.js"></script>

    <script src="./js/config/serialGeneratorConfig.js"></script>

    <script src="./js/filters/nameFilter.js"></script>
    <script src="./js/filters/ellipsisFilter.js"></script>

    <script src="./js/value/configValue.js"></script>

    <script src="./js/directives/uiAlertDirective.js"></script>
    <script src="./js/directives/uiDateDirective.js"></script>

    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/ui-alert.css">
    <link rel="stylesheet" href="css/ui-accordion.css">

    <!-- Bootstrap-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-wEmeIV1mKuiNpC+IOBjI7aAzPcEZeedi5yW5f2yOq55WWLwNGmvvx4Um1vskeMj0" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-p34f1UUtsS3wqzfto5wAAmdvj+osOnFyQFpp4Ua3gs/ZVWx6oOypYoCJhGGScy+8"
            crossorigin="anonymous"></script>

</head>
<body ng-controller="listaTelefonicaCrtl">
<div class="jumbotron">
    <h3> {{app}}</h3>

    <ui-accordions>
        <ui-accordion title="Accordion 1">
            Testando 1
        </ui-accordion>

        <ui-accordion title="Accordion 2">
            Testando 2
        </ui-accordion>
    </ui-accordions>

    <ui-alert title="Ops, aconteceu um problema!" message="errorMessage">
        Não há dados na base!
    </ui-alert>

    <input class="form-control" type="text" ng-model="criterioBusca" ng-if="!(errorMessage.length > 0)"
           placeholder="O que está buscando?"
    >
    <table ng-show="contatos.length > 0" class="table table-striped">
        <tr>
            <th></th>
            <th>Serial</th>
            <th>Nome</th>
            <th>Telefone</th>
            <th>Operadora</th>
            <th>Data</th>
            <th></th>
        </tr>
        <tr ng-class="{'selecionado negrito': contato.selecionado}" ng-repeat="contato in contatos
        | filter:criterioBusca">
            <td><input type="checkbox" ng-model="contato.selecionado"/></td>
            <td>{{ contato.serial }}</td>
            <td>{{ contato.nome | name | ellipsis}}</td>
            <td>{{ contato.telefone }}</td>
            <td>{{ contato.operadora.nome }}</td>
            <td>{{ contato.data | date:'dd/MM/yyyy'}}</td>
            <td>
                <div style="width: 20px; height: 20px;" ng-style="{'background-color': contato.cor}"></div>
            </td>
        </tr>
    </table>
    <hr>

    <form name="contatoForm">
        <input class="form-control" type="text" ng-model="contato.nome" name="nome"
               ng-minlength="10" placeholder="Nome" ng-required="true"/>

        <input
                class="form-control"
                type="text"
                ng-model="contato.telefone"
                name="telefone"
                placeholder="Telefone"
                ng-required="true"
                ng-pattern="/^\d{4,5}-\d{4}$/"
        />

        <input class="form-control" type="text" ng-model="contato.data" placeholder="Data" ui-date/>

        <select class="form-control" ng-model="contato.operadora" name="operadora"
                ng-options="operadora.nome group by operadora.categoria for operadora in operadoras | orderBy:'nome'"
                ng-required="true">
            <option value="">Selecione uma operadora</option>
        </select>
    </form>

    <div ng-show="contatoForm.nome.$dirty" ng-messages="contatoForm.nome.$error" class="alert alert-danger">
        <div ng-message="required">
            <p>Por favor, preencha o campo nome!</p>
        </div>

        <div ng-message="minlength">
            <p>O campo nome deve ter no mínimo 10 caracteres!</p>
        </div>
    </div>


    <div ng-show="contatoForm.telefone.$error.required && contatoForm.telefone.$dirty" class="alert alert-danger">
        <p>Por favor, preencha o campo telefone!</p>
    </div>
    <div ng-show="contatoForm.telefone.$error.pattern" class="alert alert-danger">
        <p>O campo telefone deve ter o formato: XXXXX-XXXX ou XXXX-XXXX!</p>
    </div>

    <button class="btn btn-primary btn-block" ng-click="adicionarContato(contato)"
            ng-disabled="contatoForm.$error.required">Adicionar
    </button>

    <button class="btn btn-danger btn-block" ng-click="excluirContatos(contatos)"
            ng-if="isContatoSelecionados(contatos)">Apagar
    </button>
</div>

<div ng-include="'view/footer.html'"></div>
</body>
</html>
